{%- macro systemd_inline_bash(caller='') -%}
  {{ " '" }}{{ (caller() | replace("\\", "\\\\") | replace("'", "\\'")).split('\n') | map('trim') | select('ne', '') | join('\\n') }}{{ "'" }}
{%- endmacro -%}

{%- set salt_warning = salt['pillar.get']('generated-file-warning-text', "WARNING: This file is automatically generated by salt, and changes to it will be discarded.") -%}

{%- macro sha256sum(task) -%}
  {{ salt['cmd.run'](["bash", "-c", 'sha256sum <<<"$sha_data" | awk "{ print \\$1 }"'], runas='nobody', env={'sha_data': task}).split(' ')[0] }}
{%- endmacro -%}

{%- macro yaml_escape(value, quote) -%}
  {{ (value | replace("\\", "\\\\") | replace(quote, "\\" + quote) | replace("\n", "\\n")) }}
{%- endmacro -%}

{%- macro yaml_string(value) -%}
  {{ '"' }}{{ yaml_escape(value, quote = "\"") }}{{ '"' }}
{%- endmacro -%}
